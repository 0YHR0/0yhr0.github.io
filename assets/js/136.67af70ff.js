(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{533:function(t,a,r){"use strict";r.r(a);var s=r(2),e=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"k8s-storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s-storage"}},[t._v("#")]),t._v(" K8s Storage")]),t._v(" "),a("h2",{attrs:{id:"k8s容器存储能力简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s容器存储能力简介"}},[t._v("#")]),t._v(" K8s容器存储能力简介")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223408638.png",alt:"image-20241015223408638"}})]),t._v(" "),a("h2",{attrs:{id:"k8s-pv-pvc-sc-dp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s-pv-pvc-sc-dp"}},[t._v("#")]),t._v(" K8s PV/PVC/SC/DP")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223408638.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223454531.png",alt:"image-20241015223454531"}})]),t._v(" "),a("h3",{attrs:{id:"静态卷-动态卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态卷-动态卷"}},[t._v("#")]),t._v(" 静态卷/动态卷")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223502944.png",alt:"image-20241015223502944"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223510244.png",alt:"image-20241015223510244"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223518588.png",alt:"image-20241015223518588"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223533680.png",alt:"image-20241015223533680"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223545578.png",alt:"image-20241015223545578"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223600084.png",alt:"image-20241015223600084"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223608041.png",alt:"image-20241015223608041"}})]),t._v(" "),a("h2",{attrs:{id:"华为云everest架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#华为云everest架构"}},[t._v("#")]),t._v(" 华为云Everest架构")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223622893.png",alt:"image-20241015223622893"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223715588.png",alt:"image-20241015223715588"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223734824.png",alt:"image-20241015223734824"}})]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"_05"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_05"}},[t._v("#")]),t._v(" 05")]),t._v(" "),a("h2",{attrs:{id:"storageclass工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#storageclass工作原理"}},[t._v("#")]),t._v(" StorageClass工作原理")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223758360.png",alt:"image-20241015223758360"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223817533.png",alt:"image-20241015223817533"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223828382.png",alt:"image-20241015223828382"}})]),t._v(" "),a("ul",[a("li",[t._v("动态卷的创建过程中StorageClass会指定使用那个provisionor")])]),t._v(" "),a("h2",{attrs:{id:"k8s中存储相关的组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s中存储相关的组件"}},[t._v("#")]),t._v(" K8s中存储相关的组件")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223839116.png",alt:"image-20241015223839116"}})]),t._v(" "),a("ul",[a("li",[t._v("AD controller：主要负责存储卷的 Attach（挂载）和 Detach（卸载）操作。当 Pod 需要使用某个存储卷时，AD Controller 确保存储卷被正确地挂载到运行该 Pod 的节点上。如果 Pod 被调度到不同的节点，它也负责将存储卷从原来的节点卸载并挂载到新的节点上\n"),a("ul",[a("li",[t._v("操作范围主要集中在存储卷与节点的关联操作上，关注存储卷在不同节点之间的挂载和卸载")]),t._v(" "),a("li",[t._v("运行在 Kubernetes "),a("strong",[t._v("控制平面")]),t._v("上，作为 Kubernetes 控制器管理器的一部分运行")]),t._v(" "),a("li",[t._v("例如，当一个使用持久化存储卷的 Pod 从一个节点迁移到另一个节点时，AD Controller 会协调存储系统和节点，使得存储卷能够在新节点上可用")])])]),t._v(" "),a("li",[t._v("kubelet Volume Manager：负责在节点上具体管理和操作存储卷。它接收来自 API Server 的指令，并在本地节点上执行存储卷的挂载、卸载、格式化等操作\n"),a("ul",[a("li",[t._v("操作范围局限于单个节点上，关注本地节点上存储卷的具体管理和操作细节")]),t._v(" "),a("li",[t._v("运行在每个 Kubernetes 节点上的 kubelet 组件中")]),t._v(" "),a("li",[t._v("比如，kubelet Volume Manager 会根据 Pod 的配置信息，将指定的存储卷挂载到 Pod 所在的容器文件系统中，使得容器可以访问存储卷中的数据。")])])]),t._v(" "),a("li",[t._v("Volume Plugin 的实现就是后面CSI介绍")])]),t._v(" "),a("h2",{attrs:{id:"云原生存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#云原生存储"}},[t._v("#")]),t._v(" 云原生存储")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223849299.png",alt:"image-20241015223849299"}})]),t._v(" "),a("h2",{attrs:{id:"csi存储架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csi存储架构"}},[t._v("#")]),t._v(" CSI存储架构")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223909784.png",alt:"image-20241015223909784"}})]),t._v(" "),a("ul",[a("li",[t._v("分为控制控制面（通过Deployment部署）和数据面（通过DaemonSet部署）")])]),t._v(" "),a("h3",{attrs:{id:"csi存储接口解读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csi存储接口解读"}},[t._v("#")]),t._v(" CSI存储接口解读")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223934638.png",alt:"image-20241015223934638"}})]),t._v(" "),a("h3",{attrs:{id:"自研csi插件的构建思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自研csi插件的构建思路"}},[t._v("#")]),t._v(" 自研CSI插件的构建思路")]),t._v(" "),a("ul",[a("li",[t._v("VA：Volume attachment是控制块存储设备的attach/detach的操作逻辑对象")]),t._v(" "),a("li",[t._v("CSI接口调用流程：对应动态卷的创建，绑定过程")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015223949211.png",alt:"image-20241015223949211"}})]),t._v(" "),a("h3",{attrs:{id:"csi插件注册流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csi插件注册流程"}},[t._v("#")]),t._v(" CSI插件注册流程")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015224005758.png",alt:"image-20241015224005758"}})]),t._v(" "),a("h2",{attrs:{id:"flexvolume向csi迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flexvolume向csi迁移"}},[t._v("#")]),t._v(" FlexVolume向CSI迁移")]),t._v(" "),a("ul",[a("li",[t._v("FlexVolume是之前的动态卷创建方式，在K8s后续版本中会日落（移除）")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015224017820.png",alt:"image-20241015224017820"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015224027541.png",alt:"image-20241015224027541"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015224038357.png",alt:"image-20241015224038357"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20241015224047426.png",alt:"image-20241015224047426"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);